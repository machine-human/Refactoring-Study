# 코드의 구린내

###### 내용에 나오는 각 기법에 대해서는 내용 추가 후 링크 연결 예정입니다.

</br>

## 중복 코드 (Duplicated Code)

##### 구랜내의 제왕은 중복 코드, 똑같은 코드 구조가 두 군데 이상 있을 때는 그 부분을 하나로 통일하면 프로그램이 개선된다.

</br>

[1] 한 클래스의 두 메서드 안에 같은 코드가 들어 있는 경우

- **메서드 추출 기법**을 이용해 겹치는 코드를 별도의 메소드로 만들고 그 메서드를 두 곳에서 호출

</br>

[2] 한 클래스의 두 하위클래스에 같은 코드가 들어 있는 경우

- **메서드 추출 기법**을 이용해 중복을 없앤 후 **메서드 상향 기법**을 적용

</br>

[3] 코드가 똑같지 않고 비슷하다면

- **메서드 추출 기법**을 이용해서 같은 부분과 다른 부분을 분리 후 경우에 따라 **템플릿 메서드 형성 기법** 적용

</br>

[4] 두 메서드가 알고리즘만 다르고 기능이 같다면 

- 더 간단한 것을 택해서 **알고리즘 전환 기법** 적용

</br>

[5] 중복 코드가 메서드 가운데에 있다면

- 주변 **메서드 추출**을 적용

</br>

[6] 서로 상관없는 두 클래스 안에 중복 코드가 있다면

1. 한 클래스 안의 중복 코드를 
   **클래스 추출 기법** 또는 **모듈 추출 기법** 적용해 
   제 3의 클래스나 모듈로 떼어낸 후 그것을 다른 클래스에서 호출

2. 중복 코드를 빼서 메서드로 만든 후 
   그 메서드를 두 클래스 중 하나에 넣고 
   다른 클래스에서 그 메서드를 호출

3. 제 3의 클래스에 넣고 그걸 두 클래스에서 호출

</br>

## 장황한 메서드 (Long Method)

##### 최적의 상태로 장수하는 객체 프로그램을 보면 공통적으로 메서드 길이가 짧다

</br>

[1] 짧은 메서드를 이해하기 쉽게 하려면 메서드명을 잘 정해야 한다

- 기능 수행 방식이 아니라 목적(기능 자체)를 나타내는 이름

</br>

[2] 메서드를 줄이려면 십중팔구는 메서드 추출 기법을 적용

</br>

[3] 메서드 추출 기법을 적용 하려면 수많은 매개변수와 임시변수를 새로 만든 메서드의 매개변수로 넘겨야 하는데, 그렇게 되면 가동성이 원래의 코드와 별 다를게 없음

- 웬만한 경우 메서드 호출로 전환 기법이나 임시변수를 메서드 체인으로 전환 기법을 적용하면 임시변수가 제거 됨
- 길게 열거된 매개변수는 매개변수 세트를 객체로 전환기법과 객체를 통째로 전달 기법을 적용
- 이런 리팩토링 기법 적용했어도 여전히 임시변수와 매개변수가 많은 경우 메서드를 메서드 객체로 전환 기법을 적용

</br>

[4] 조건문과 루프믄 역시 메서드로 추출

- 조건문은 조건문 쪼개기 기법을 적용
- 루프는 루프를 컬렉션 클로저 메서드로 전환을 실시한 후 그 클로저 메서드 호출과 클로저 자체에 메서드 추출을 실시

</br>

## 방대한 클래스 (Large Class)

##### 기능이 지나치게 많은 클래스에는 보통 엄청난 수의 인스턴스 변수가 들어 있고 인스턴스 변수가 너무 많으면 중복 코드가 반드시 존재하기 마련

</br>

[1] 클래스 추출 기법으로 수많은 인스턴스 변수를 하나로 묶을 수 있음

- 하위 클래스 추출 기법 or 모듈 추출 기법

- 서로 연관된 변수를 골라서 클래스로 빼내면 됨
- 한 클래스 안의 일부 변수가 접두어나 접미어가 같다면 하나의 클래스로 추출하는 게 좋음

</br>

[2] 인스턴스 변수를 계속해서 모두 사용하지 않는 클래스

- 클래스 추출, 모듈 추출, 하위클래스 추출 중 하나를 여러 번 적용

</br>

[3] 코드량이 너무 방대한 클래스에도 중복 코드가 많이 있기 마련

- 클래스 추출, 모듈 추출, 하위클래스 추출 중 하나를 여러 번 적용

</br>

[4] 방대한 클래스가 GUI 클래스라면

- 데이터와 기능을 서로 다른 도메인 객체로 옮겨야 할 수도 있음
- 관측 데이터 복제 기법을 실시

</br>

## 과다한 매개변수 (Long Parameter List)

</br>

## 수정의 산발 (Divergent Change)

##### 한 클래스가 다양한 원인 때문에 다양한 방식으로 자주 수정될 때 일어남

</br>

[1] '새 데이터베이스를 생성할 때마다 이 3개의 메서드를 수정해야 하고, 새 금융 상품을 추가할 때마다 이 4개의 메서드를 수정해야 하네!' 생각이 들때

- 여러 개의 변형 객체로 분리하는 것이 좋음

</br>

## 기능의 산재 (Shotgun Surgery)

##### 수정의 산발과 비슷하지만 정 반대. 수정할 때마다 여러 클래스에서 수많은 자잘한 부분을 고쳐야 할때 문제를 의심

</br>

[1] 수정할 부분이 여기저기에 있다면 찾기도 힘들 뿐더러 꼭 수정해야 하는 부분을 놓치기 쉬움

- 메서드 이동 기법과  필드 이동 기법 적용을 적용해서 수정할 부분들을 전부 하나의 클래스 안에 넣어야 함

- 어느 것에 넣기에도 부적절해 보일 때는 새 클래스 생성

- 대개는 클래스 내용 직접 삽입 기법을 적용해서 별도 클래스에 분산되어 있던 모든 기능을 한곳으로 가져와도 됨

  (수정의 산발 문제가 조금 생기지만, 그 정도는 간단히 처리 가능)

</br>

## 잘못된 소속 (Feature Envy)

##### 어떤 메서드가 자신이 속하지 않은 클래스에 더 많이 접근할때

</br>

[1] 메서드 이동 기법을 이용하여 더 자주 접근하는 클래스로 이동

</br>

[2] 일부분만 소속이 잘못된 경우

- 그 부분에 메서드 추출 기법을 적용 후 메서드 이동을 적용해서 적절한 클래스로 이동

</br>

[3] 한 메서드가 여러 클래스에 들어 있는 기능을 이용할 때

- 메서드 추출 후 메서드가 접근하는 데이터가 어느 클래스에 제일 많이 들어 있는지 파악해서 해당 클래스로 이동

</br>

## 데이터 뭉치 (Data Clumps)

##### 두 클래스에 들어 있는 인스턴스 변수나 여러 메서드 시그너처에 들어 있는 매개변수처럼, 동일한 3~4개의 데이터 항목이 여러 위치에 몰려 있는 경우

</br>

[1] 몰려 있는 데이터 뭉치의 필드들을 대상으로 클래스 추출 기법 적용 후 메서드 시그너처를 대상으로 매개변수 세트를 객체로 전환 기법과 객체를 통째로 전달 기법을 적용하여 간결하게 만듬

</br>

## 강박적 기본 타입 사용 (Primitive Obsession)

**객체를 처음 접하는 사람은 보통 숫자와 통화를 연동하는 돈 관련 클래스나 전화번호와 우편번호와 같이 특수 문자열 클래스 등의 사소한 작업에 작은 객체를 잘 사용하지 않음**

</br>

[1] 이러한 버릇을 벗어나려면

- 데이터 값을 객체로 전환 실시
- 조건문에 분류 부호가 사용될 땐 분류 부호를 하위클래스로 전환
- 또는 분류 부호를 상태/전략 패턴으로 전환 기법 적용

</br>

[2] 뭉쳐 다녀야 할 여러 개의 필드가 있다면

- 클래스 추출 기법 적용

</br>

[3] 이런 기본 타입이 매개변수 세트에 들어 있다면

- 매개변수 세트를 객체로 전환 기법 적용

</br>

[4] 배열 때문에 불편하다면

- 배열을 객체로 전환 기법 적용

</br>

## switch 문 (Switch Statements)

**switch 문의 단점은 반드시 중복이 생김**

</br>

[1] 같은 switch 문이 프로그램 곳곳에 있을 때가 많음,  switch 문에 새 코드 행을 추가하려면 그렇게 여기저기에 존재하는 switch 문을 전부 찾아서 수정이 필요

- 이러한 문제점을 해결하기 위해서는 재정의를 이용하는 것(다형성)
- 대부분의 switch 문은 재정의로 바꿔야 함

</br>

## 평행 상속 계층 (Parallel Inheritance Hierarchies)

</br>

## 직무유기 클래스 (Lazy Class)

**기존에는 비용 대비 효율성이 좋았으나 리팩토링 실시 후 기능이 축소된 클래스,**
**수정할 계획으로 작성했으나 수정을 실시하지 않아 쓸모 없어진 클래스**

</br>

[1] 비용 대비 효율이 떨어지는 하위 클래스나 모듈이 있을때

- 계층 병합 실시

</br>

[2] 쓸모 없는 구성 요소에는

- 클래스 내용 직접 삽입이나 모듈 내용 직접 삽입 기법 적용

</br>

## 막연한 범용 코드 (Speculative Generality)

</br>

[1] 별다른 기능이 없는 클래스나 모듈이 있다면

- 계층 병합 실시

</br>

[2] 불필요한 위임을 제거하려면

- 클래스 내용 직접 삽입 실시

</br>

[3] 메서드에 사용되지 않는 매개변수가 있으면

- 매개변수 제거 실시

</br>

[4] 메서드명이 이상하다면

- 메서드명 변경 실시

</br>

[5] 메서드나 클래스가 오직 테스트 케이스에만 사용된다면

- 그것과 그것을 실행하는 테스트 케이스를 모두 삭제
- 단, 적절한 기능을 실행하는 테스트 케이스용 헬퍼 메서드나 클래스는 제외

</br>

## 임시 필드 (Temporary Field)

**어떤 객체 안에 인스턴스 변수가 특정 상황에서만 할당되는 경우**

</br>

[1] 클래스 추출 기법 적용 후 작성한 클래스에 그 변수들과 관련된 코드를 전부 넣어야 함

</br>

## 메시지 체인 (Message Chains)

**클라이언트가 한 객체에 제 2의 객체를 요청하면, 제 2의 객체가 제 3의 객체를 ... 요청하는 식으로 연쇄적 요청이 발생하는 문제점**

</br>

[1] 대리 객체 은폐 실시

</br>

## 과잉 중개 메서드 (Middle Man)

</br>

[1] 어떤 클래스의 인터페이스 안에 절반도 넘는 메소드가 기능을 다른 클래스에 위임하고 있다면

- 과잉 중개 메서드 제거 기법 적용해서 원리가 구현된 객체에 직접 접근

</br>

[2] 일부 메서드에 별 기능이 없다면, 메서드 내용 직접 삽입 실시 후 메서들의 내용을 호출 객체에 직접 삽입

</br>

[3] 부수적인 기능이 있다면

- 위임을 상속으로 전환 기법을 적용해서 중개 메서드를 실제 객체의 하위 클래스로 전환

</br>

## 지나친 관여 (Inappropriate Intimacy)

</br>

[1] 메서드 이동 기법과 필드 이동 기법을 실시해서 각 클래스를 분리 후 지나친 관여를 줄여야 함

</br>

[2] 클래스의 양방향 연결을 단방향으로 전환 기법을 적용할 수 있는지 판단 후 공통 부분을 클래스 추출

</br>

[3] 아니면 대리 객체 은폐를 실시하여 다른 클래스가 중개 메서드 역할을 하게 만들어도 됨

</br>

[4] 상위 클래스에서 하위 클래스를 빼내야 할 경우에는 상속을 위임으로 전환 기법을 적용

</br>

## 인터페이스가 다른 대용 클래스

</br>

[1] 기능은 같은데 시그너처가 다른 메서드는

- 메서드명 변경 기법 실시
- 하지만 이 기법만 적용해선 충분하지 않으므로
- 프로토콜이 같아질 때까지 메서드 이동을 실시해서 기능을 해당 클래스로 옮김
- 단, 너무 여러번 옮겨야 한다면 상위클래스 추출 실시

</br>

## 미흡한 라이브러리 클래스 (Incomplete Library Class)

</br>

[1] 라이브러리 클래스에 넣어야 할 메서드가 두 개뿐이라면

- 외래 클래스에 메서드 추가 기법을 실시

</br>

[2] 부가 기능이 많을 때는 

- 국소적 상속확장 클래스 사용 기법을 실시

</br>

## 데이터 클래스 (Data Class)

**필드와 필드 읽기/쓰기 메서드만 들어 있는 클래스, 오로지 데이터 보관만 담당하며, 구체적 데이터 조작은 다른 클래스가 수행**

</br>

[1] public 필드 일 경우

- 필드 캡슐화 기법 실시

</br>

[2] 컬렉션 필드가 있으면

- 컬렉션 캡슐화 기법 적용

</br>

[3] 변경되지 않아야 하는 필드에는

- 쓰기 메서드 제거 기법 적용

</br>

[4] 읽기/쓰기 메서드가 다른 클래스에 의해 사용되는 부분을 찾아서 메서드 이동 기법 실시

- 메서드 전체를 옮길 수 없다면 메서드 추출을 실시해서 옮길 수 있는 메서드를 작성
- 그 후 읽기/쓰기 메서드에 메서드 은폐 기법을 적용

</br>

## 방치된 상속물 (Refused Bequest)

</br>

[1] 상위 클래스로 부터 상속 받은 메서드나 데이터가 하위클래스에서 더 이상 쓰이지 않거나 필요 없을때

- 새 대등 클래스를 작성하고 메서드 하양과 필드 하양 기법 실시
- 사용되지 않는 모든 메서드를 그 형제 클래스에 몰아넣어야 함
- 이렇게 하면 상위클래스에는 공통 코드만 들어 있게 됨

</br>

[2] 하위클래스가 기능은 재사용하지만 상위클래스의 인터페이스를 지원하진 않을 때

- 상속구현을 거부하는 것은 상관없지만, 인터페이스를 거부하는 것은 문제
- 계층구조를 건드려서는 안 되고, 상속을 위임으로 전환 기법을 적용해 계층 구조를 없애야 함

</br>

## 불필요한 주석 (Comments)

##### 주석을 거론하는 이유는 주석이 구린내를 감춰주는 탈취제 용도로 쓰일 때가 많기 때문

</br>

[1] 어떤 코드 구간의 기능을 설명할 주석이 필요할 때는 메서드 추출을 실행해야 함

- 추출 후에도 주석이 필요하다면 메서드명 변경 기법 적용

</br>



###### 