# 임시변수를 메서드 호출로 전환

###### Replace Temp with Query

수식의 결과를 저장하는 임시변수가 있을 땐 그 수식을 빼내어 메서드로 만든 후,
임시변수 참조 부분을 전부 수식으로 교체하자. (새로 만든 메서드는 다른 메서드에서도 호출 가능하다.)
</br>
</br>

[보기]

- 변경 전

  ```java
  double basePrice = quantity * itemPrice;
  if (basePrice > 1000)
      return basePrice * 0.95;
  else
      return basePrice * 0.98;
  ```
</br>

- 변경 후

  ```java
  if (basePrice() > 1000)
      return basePrice * 0.95;
  else
      return basePrice * 0.98;
  ...
  
  double basePrice() {
      return quantity * itemPrice;
  }
  ```
</br>

[방법]

1. 값이 한 번만 대입되는 임시변수를 찾자
   
   (여러 번 대입되는 임시변수라면 임시변수 분리 기법 실시 고려)
   
2. 그 임시변수를 final로 선언

3. 컴파일 실시
   (문제가 있으면 임시변수를 해당 기법을 실시하면 안 되므로 컴파일 먼저 실시)

   (이것으로 임시변수엔 값을 한 번만 대입할 수 있음)

4. 대입문 우변을 빼내어 메서드로 만듬

   (처음엔 메서드를 private로 선언하고 추후 여러 곳에서 사용하게 되면 접근 제한을 간단히 완화하면 됨)

   (추출 메서드에 문제(객체를 변경하진 않는지)는 없는지 확인 후 만약 문제가 있다면 상태 변경 메서드와 값 반환 메서드를 분리 기법을 실시)

5. 컴파일과 테스트 실시

6. 임시변수를 대상으로 임시변수 내용 직접 삽입 기법 실시
</br>

[예제]

- 수정 전

  ```java
  private double getPrice() {    
      double basePrice = quantitiy * itemPrice;    
      double discountFactor = 0;    
      if (basePrice > 1000) basePrice = 0.95;    
      else discountFactor = 0.98;    
      return basePrice * discountFactor;
  }
  ```
</br>

- 수정 후

  - 임시변수를 한 번에 하나씩 메서드 호출로 변경
    1. basePrice -> basePrice() 메서드
    2. discountFactor -> discountFactor() 메서드

  ```java
  private double getPrice() {    
      return basePrice() * discountFactor();
  }
  
  private double basePrice() {    
      return quantitiy * itemPrice;
  }
  
  private double discountFactor() {    
      if (basePrice() > 1000) return 0.95;    
      else return 0.98;
  }
  ```
