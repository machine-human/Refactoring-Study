# 대리 객체 은폐

###### Hide Delegate

클라이언트가 객체의 대리 클래스를 호출할 땐 대리 클래스를 감추는 메서드를 서버에 작성하자

</br>

[클래스 다이어그램]

![Hide Delegate.PNG](https://raw.githubusercontent.com/machine-human/Refactoring-Study/master/image/Hide%20Delegate.PNG)

</br>

[방법]

1. 대리 객체에 들어 있는 각 메서드를 대상으로 서버에 간단한 위임 메서드를 작성하자

</br>

2. 클라이언트를 수정해서 서버를 호출하게 만들자
   (클라이언트 클래스가 서버 클래스와 같은 패키지에 있지 않다면 대리 메서드의 접근을 같은 패키지에 든 클래스만 접근할 수 있게 수정하는 것을 고려하자)

</br>

3. 각 메서드를 수정할 때마다 컴파일과 테스트를 실시

</br>

4. 대리 객체를 읽고 써야 할 클라이언트가 하나도 남지 않게 되면, 서버에서 대리 객체가 사용하는 읽기/쓰기 메서드를 삭제하자

</br>

5. 컴파일과 테스트 실시

</br>

[예제]

- 수정 전

  ```java
  public class Person {  
      Department department;    
      
      public Department getDepartment() {   
          return department; 
      }   
      
      public void setDepartment(Department department) {   
          this.department = department; 
      }
  }
  ```
  
  ```java
  public class Department ...  
      private String chargeCode; 
      private Person manager; 
      
      public Department(Person manager) { 
          this.manager = manager;  
      }  
      
      public Person getManager() {     
          return manager;   
      }   
      
      public String getChageCode() {   
          return chargeCode;   
      }  
      
      public void setChageCode(String chargeCode) {   
          this.chargeCode = chargeCode;
      }
  ...
  ```
  
  ```java
  //클라이언트의 요청
  //아래 코드를 보면 Department 클래스의 원리와 
  //Department 클래스의 기능이 팀장 정보를 지속적으로 알아내는 것임을 알 수 있음
  //이런 의존성을 줄이려면 Department 클래스를 클라이언트가 알 수 없게 감춰야 함
  manager = john.getDepartment().getManager();
  ```

</br>

- 수정 후

  - Person 클래스에 getManager() 메서드 생성 (위임 메서드)
  - 이후 새 메서드를 사용하게끔 Person 클래스의 모든 참조 부분을 수정
  - Person 클래스의 getDepartment() 메서드 삭제
  
  ```java
  public class Person {  
      Department department;  
      
      public void setDepartment(Department department) { 
          this.department = department; 
      }   
      
      public Person getManager() {     
        return department.getManager();  
      }
  }
  ```
  
  ```java
  //클라이언트의 요청
  //새 메서드를 사용하게끔 Person 클래스의 모든 참조 부분을 수정
  manager = john.getManager();
  ```

