# 상속을 위임으로 전환

###### Replace Inheritance with Delegation

하위클래스가 상위클래스 인터페이스의 일부만 사용할 때나 데이터를 상속받지 않게 해야 할 땐

상위클래스에 필드를 삭성하고, 모든 메서드가 그 상위클래스에 위임하게 수정한 후 하위클래스를 없애자

</br>

[클래스 다이어그램]

![Replace Inheritance with Delegation.PNG](https://raw.githubusercontent.com/machine-human/Refactoring-Study/master/image/Replace%20Inheritance%20with%20Delegation.PNG)

</br>

[방법]

1. 하위클래스 안에 상위클래스의 인스턴스를 참조하는 필드를 작성

</br>

2. 그 필드를 this로 초기화

</br>

3. 하위클래스 안의 각 메서드를 수정해서 대리 필드를 사용하게 하자

</br>

4. 각 메서드를 수정할 때마다 컴피알과 테스트를 실시

   (super의 메서드를 호출하는 하위클래스의 모든 메서드는 수정할 수 없거나,)

   (수정할 수 있더라도 무한 루프에 빠질 가능성이 있다)

   (이런 메서드를 수저하려면 상속 구조를 깨야 함)

</br>

5. 하위클래스 선언을 삭제하고 대리 객체 대입 부분을 새 객체 대입으로 바꾸자

</br>

6. 클라이언트가 사용하는 상위클래스 메서드마다 간단한 위임 메서드를 추가

</br>

7. 컴파일과 테스트를 실시

</br>

[예제 - 미확인 예외]

- 수정 전

  ```java
  public class MyStack extends Vector {
      public void push(Object element) {
          insertElementAt(element, 0);
      }
  
      public Object pop() {
          Object result = firstElement();
          removeElementAt(0);
          return result;
      }
  }
  ```

</br>

- 수정 후

  ```java
  public class MyStack {
      private Vector vector = new Vector();
  
      public void push(Object element) {
          vector.insertElementAt(element, 0);
      }
  
      public Object pop() {
          Object result = vector.firstElement();
          vector.removeElementAt(0);
          return result;
      }
  
      public int size() {
          return vector.size();
      }
  
      public boolean isEmpty() {
          return vector.isEmpty();
      }
  }
  ```
