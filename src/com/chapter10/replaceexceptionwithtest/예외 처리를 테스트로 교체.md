# 예외 처리를 테스트로 교체 

###### Replace Exception with Test 

호출 부분에 사전 검사 코드를 넣으면 될 상황인데 예외 통지를 사용했을 땐 호출 부분이 사전 검사를 실시하게 수정하자

</br>

[보기]

- 변경 전

  ```java
      double getValueForPeriod(int peroidNumber) {
          try {
              return values[peroidNumber];
          } catch (ArrayIndexOutOfBoundsException e) {
              return 0;
          }
      }
  ```

</br>

- 변경 후

  ```java
      double getValueForPeriod(int peroidNumber) {
          if (peroidNumber >= values.length) {
              return 0;
          } else {
              return values[peroidNumber];
          }
      }
  ```

</br>


[방법]

1. 테스트를 앞에 넣고 catch 절의 코드를 if 문의 적절한 절로 복사하자

</br>

2. catch 절이 실행되는지 여부가 표시되게 catch 절에 어설션을 넣자

</br>

3. 컴파일과 테스트를 실시 

</br>

4. catch 절을 삭제하고, 다른 catch 절이 없으면 try 절도 삭제하자

</br>

5. 컴파일과 테스트를 실시

</br>

[예제]

- 수정 전

  ```java
  public class Basic {
      Integer[] values = new Integer[10];
  
      double getValueForPeriod(int peroidNumber) {
          try {
              return values[peroidNumber];
          } catch (ArrayIndexOutOfBoundsException e) {
              return 0;
          }
      }
  }
  ```
  
  ```c++
  public class ResoucrePool {
      Stack available;
      Stack allocated;
  
      Resource getResource() {
          Resource result;
          try {
              result = (Resource) available.pop();
              allocated.push(result);
              return result;
          } catch (EmptyStackException e) {
              result = new Resource();
              allocated.push(result);
              return result;
          }
      }
  }
  ```
  
  ```c++
  public class Resource {}
  ```

</br>

- 수정 후

  ```java
  public class Basic {
      Integer[] values = new Integer[10];
  
      double getValueForPeriod(int peroidNumber) {
          if (peroidNumber >= values.length) {
              return 0;
          } else {
              return values[peroidNumber];
          }
      }
  }
  ```
  
  ```c++
  public class ResoucrePool {
      Stack available;
      Stack allocated;
  
      Resource getResource() {
          Resource result;
          if (available.isEmpty()) {
              result = new Resource();
              allocated.push(result);
              return result;
          } else {
              result = (Resource) available.pop();
              allocated.push(result);
              return result;
  
              //테스트 후 예외가 발생하지 않으면 try 절을 완전히 삭제
              /*
              try {
                  result = (Resource) _available.pop();
                  _allocated.push(result);
                  return result;
              } catch (EmptyStackException e) {
                  Assert.shouldNeverReachHere("pop 실행 시에 available이 비어 있음");
                  result = new Resource();
                  _allocated.push(result);
                  return result;
              }*/
          }
      }
  }
  
  class Assert {
      static void shouldNeverReachHere(String message) {
          throw new RuntimeException(message);
      }
  }
  ```
  
  ```c++
  public class Resource {}
  ```
