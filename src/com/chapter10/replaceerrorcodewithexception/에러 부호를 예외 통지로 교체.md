# 에러 부호를 예외 통지로 교체 

###### Replace Error Code with Exception 

메서드가 에러를 나타내는 특수한 부호를 반환할 땐
그 부호 반환 코드를 예외 통지 코드로 바꾸자

</br>

[보기]

- 변경 전

  ```java
      int withdraw(int amount) {
          if (amount > balance) {
              return -1;
          } else {
              balance -= amount;
              return 0;
          }
      }
  ```

</br>

- 변경 후

  ```java
      void withdraw(int amount) throws BalanceException {
          if (amount > balance) {
              throw new BalanceException();
          } else {
              balance -= amount;
          }
      }
  ```

</br>

[방법]

1. 확인된 예외와 미확인 예외 중 어느 것을 사용해야 할지 판단
   (호출 전에 호출하는 부분이 조건을 검사해야 한다면 미확인 예외로 하자)
   (예외가 확인된 것이면 새 예외를 작성하거나 기존 예외를 사용)

</br>

2. 호출 부분을 전부 찾아서 그 예외를 사용하게 수정하자
   (미확인 예외일 땐 호출 부분이 메서드 호출 전에 적절한 검사를 하게 하자)
   (하나식 수정할 때마다 컴파일과 테스트를 실시)
   (확인된 예외일 땐 호출 부분이 try 절 안에서 메서드를 호출하게 하자)

</br>

3. 메서드 시그너처를 수정해서 새로운 용도를 반영하자

</br>

[예제 - 미확인 예외]

- 수정 전

  ```java
  public class Account {
      private int balance = 10;
  
      public static void main(String[] args) {
          Account account = new Account();
  
          int amount = 11;
          if (account.withdraw(amount) == -1) {
              handleOverdrawn();
          } else {
              doTheUsualThing();
          }
      }
  
      private static void doTheUsualThing() {
          System.out.println("출금 가능");
      }
  
      private static void handleOverdrawn() {
          System.out.println("에러");
      }
  
      int withdraw(int amount) {
          if (amount > balance) {
              return -1;
          } else {
              balance -= amount;
              return 0;
          }
      }
  }
  ```

</br>

- 수정 후

  ```java
  public class Account {
      private int balance = 10;
  
      public static void main(String[] args) {
          Account account = new Account();
  
          int amount = 11;
          if (!account.canWithdraw(amount)) {
              handleOverdrawn();
          } else {
              account.withdraw(amount);
              doTheUsualThing();
          }
      }
  
      private static void doTheUsualThing() {
          System.out.println("출금 가능");
      }
  
      private static void handleOverdrawn() {
          System.out.println("에러");
      }
  
      boolean canWithdraw(int amount) {
          if (balance > amount) {
              return true;
          } else {
              return false;
          }
      }
  
      void withdraw(int amount) {
          Assert.isTrue("잔액이 충분합니다.", amount <= balance);
          balance -= amount;
      }
  }
  ```
  
  ```c++
  public class Assert {
      static void isTrue(String comment, boolean test) {
          if (!test) {
              throw new RuntimeException("어설션 실패: " + comment);
          }
      }
  }
  ```

</br>

[예제 - 확인된 예외]

- 수정 전

  ```java
  public class Account {
      private int balance = 10;
  
      public static void main(String[] args) {
          Account account = new Account();
  
          int amount = 11;
          if (account.withdraw(amount) == -1) {
              handleOverdrawn();
          } else {
              doTheUsualThing();
          }
      }
  
      private static void doTheUsualThing() {
          System.out.println("출금 가능");
      }
  
      private static void handleOverdrawn() {
          System.out.println("에러");
      }
  
      int withdraw(int amount) {
          if (amount > balance) {
              return -1;
          } else {
              balance -= amount;
              return 0;
          }
      }
  }
  ```
  
  ```c++
  public class BalanceException extends Exception {}
  ```

</br>

- 수정 후

  ```java
  public class Account {
      private int balance = 10;
  
    public static void main(String[] args) {
          Account account = new Account();
          int amount = 11;
          try {
              account.withdraw(amount);
              doTheUsualThing();
          } catch (BalanceException e) {
              handleOverdrawn();
          }
      }
  
      private static void doTheUsualThing() {
          System.out.println("출금 가능");
      }
  
      private static void handleOverdrawn() {
          System.out.println("에러");
      }
  
      void withdraw(int amount) throws BalanceException {
          if (amount > balance) {
              throw new BalanceException();
          } else {
              balance -= amount;
          }
      }
  }
  
  ```
  
  ```c++
  public class BalanceException extends Exception {}
  ```