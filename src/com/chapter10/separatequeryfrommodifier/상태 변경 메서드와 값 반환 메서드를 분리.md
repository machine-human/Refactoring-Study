# 상태 변경 메서드와 값 반환 메서드를 분리

###### Separate Query from Modifier

값 반환 기능과 객체 상태 변경 기능이 한 메서드에 들어 있을 땐 질의 메서드와 변경 메서드로 분리하자

</br>

[클래스 다이어그램]

![Separate Query from Modifier.PNG](https://raw.githubusercontent.com/machine-human/Refactoring-Study/master/image/Separate%20Query%20from%20Modifier.PNG)

</br>

[방법]

1. 원본 메서드와 같은 값을 반환하는 값 반환 메서드를 작성하자

</br>

2. 메서드 호출의 결과를 밯놘하게 원본 메서드를 수정하자

</br>

3. 컴파일과 테스트를 실시 

</br>

4. 각 호출에 대해 한 번의 원본 메서드 호출을 값 반환 메서드 호출로 수정하자

</br>

5. 값 반환 메서드 호출 행 앞에 원본 메서드 호출을 추가하자

</br>

6. 호출 메서드를 하나 수정할 때마다 테스트 하자

</br>

7. 원본 메서드를 void 타입으로 수정하고 안의 return문을 삭제

</br>

[예제]

- 수정 전

  ```java
  public class Example01 {
      void checkSecurity(String[] people) {
          String found = foundMiscreant(people);
          someLaterCode(found);
      }
  
      private void someLaterCode(String found) {
      }
  
      String foundMiscreant(String[] people) {
          for (int i = 0; i < people.length; i++) {
              if (people[i].equals("Don")) {
                  sendAlert();
                  return "Don";
              }
  
              if (people[i].equals("John")) {
                  sendAlert();
                  return "John";
              }
          }
          return "";
      }
  
      private void sendAlert() {
      }
  }
  ```

</br>

- 수정 후

  - 값 반환 메서드와 상태 변경 메서드로 분리
  
  ```java
  public class Example01 {
      void checkSecurity(String[] people) {
          //변경 메서드를 먼저 호출한 후 값 반환 메서드를 호출하게 변경
          sendAlert(people);
          String found = foundPerson(people);
          someLaterCode(found);
      }
  
      private void someLaterCode(String found) {
      }
  
      //상태 변경 메서드
      void sendAlert(String[] people) {
          for (int i = 0; i < people.length; i++) {
              if (!foundPerson(people).equals("")) {
                  sendAlert();
              }
          }
      }
  
      //값 반환 메서드
      //부작용이 없는 적절한 질의 메서드
      String foundPerson(String[] people) {
          for (int i = 0; i < people.length; i++) {
              if (people[i].equals("Don")) {
                  sendAlert();
                  return "Don";
              }
  
              if (people[i].equals("John")) {
                  sendAlert();
                  return "John";
              }
          }
          return "";
      }
  
      private void sendAlert() {
      }
  }
  ```
  
