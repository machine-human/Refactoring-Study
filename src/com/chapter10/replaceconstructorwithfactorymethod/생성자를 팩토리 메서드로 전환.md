# 새성자를 팩토리 메서드로 전환 

###### Replace Constructor with Factory Method

객체를 생성할 때 단순한 생성만 수행하게 해야 할 땐
생성자를 팩토리 메서드로 교체하자

</br>

[보기]

- 변경 전

  ```java
      Employee(int type) {
          this.type = type;
      }
  ```

</br>

- 변경 후

  ```java
      static Employee create(int type) {
          return new Employee(type);
      }
  ```

</br>

[방법]

1. 팩토리 메서드를 작성하자

</br>

2. 그 메서드의 내용을 기존의 생성자 호출로 수정하자

</br>

3. 하나씩 바꿀 때마다 컴파일과 테스트를 실시하자

</br>

4. 생성자를 private로 선언하자

</br>

5. 컴파일하자

</br>

[예제 - 1]

- 수정 전

  ```java
  public class Employee {
      static final int ENGINEER = 0;
      static final int SALESMAN = 1;
      static final int MANAGER = 2;
      private int type;
  
      Employee(int type) {
          this.type = type;
      }
  
      public static void main(String[] args) {
          Employee eng = new Employee(Employee.ENGINEER);
      }
  }
  ```

</br>

- 수정 후

  - 팩토리 메서드 create() 작성
  
  ```java
  public class Employee {
      static final int ENGINEER = 0;
      static final int SALESMAN = 1;
      static final int MANAGER = 2;
      private int type;
  
      private Employee(int type) {
          this.type = type;
      }
  
      static Employee create(int type) {
          return new Employee(type);
      }
  
      public static void main(String[] args) {
          Employee eng = new Employee(Employee.ENGINEER);
      }
  }
  ```
  

</br>

[예제 - 2]

- 수정 전

  ```java
  public class Employee {
      private int type;
      static final int ENGINEER = 0;
      static final int SALESMAN = 1;
      static final int MANAGER = 2;
  
      static Employee create(int type) {
          switch (type) {
              case ENGINEER:
                  return new Engineer();
              case SALESMAN:
                  return new Salesman();
              case MANAGER:
                  return new Manager();
              default:
                  throw new IllegalArgumentException("없는 분류 부호 값");
          }
      }
  
      public static void main(String[] args) {
          Employee eng = Employee.create(Employee.ENGINEER);
      }
  }
  
  class Engineer extends Employee {
  
  }
  
  class Salesman extends Employee {
  
  }
  
  class Manager extends Employee {
  
  }
  ```

</br>

- 수정 후

  ```java
  public class Employee {
      static final int ENGINEER = 0;
      static final int SALESMAN = 1;
    static final int MANAGER = 2;
      private int type;
  
      @Deprecated
      static Employee create(int type) {
          switch (type) {
              case ENGINEER:
                  return create("Engineer");
              case SALESMAN:
                  return create("Salesman");
              case MANAGER:
                  return create("Manager");
              default:
                  throw new IllegalArgumentException("없는 분류 부호 값");
          }
      }
  
      static Employee create(String name) {
          try {
              //새 하위클래스를 추가해야 할 땐 생성 된 switch 문을 반드시 수정해야 함
              //하지만 이 작업은 잊기 쉬움
              //잊는 것을 방지하려면 Class.forName을 사용하는 것이 좋다.
              return (Employee) Class.forName(name).newInstance();
          } catch (Exception e) {
              throw new IllegalArgumentException("객체 " + name + "를 인스턴스화할 수 없음");
          }
      }
  
      public static void main(String[] args) {
          //정수 타입을 매개변수로 받는 create 메서드를 string을 매개변수로 받는 새 메서드 호출로 변경
          //Employee eng = Employee.create(Employee.ENGINEER);
          Employee eng = Employee.create("Enginner");
      }
  }
  
  class Engineer extends Employee {
  
  }
  
  class Salesman extends Employee {
  
  }
  
  class Manager extends Employee {
  
  }
  ```
  

</br>

[예제 - 3]

- 수정 전

  ```java
  public class Execute {
      public static void main(String[] args) {
          Person kent = new Male();
      }
  }
  ```
  
  ```c++
  public class Person {
      static Person createMale() {
          return new Male();
      }
  
      static Person createFemale() {
          return new Female();
      }
  }
  
  class Male extends Person {
  
  }
  
  class Female extends Person {
  
  }
  ```

</br>

- 수정 후

  - 생성 자 호출 부분 변경 Person kent = new Male(); -> Person kent = Person.createMale();
  
  ```java
  public class Execute {
      public static void main(String[] args) {
          Person kent = Person.createMale();
      }
  }
  ```
  
  ```c++
  public class Person {
      static Person createMale() {
          return new Male();
      }
  
      static Person createFemale() {
          return new Female();
      }
  }
  
  class Male extends Person {
  
  }
  
  class Female extends Person {
  
  }
  ```